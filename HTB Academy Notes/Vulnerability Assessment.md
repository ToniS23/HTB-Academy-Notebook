
01-10-2024 11:58 am

Tags: [[CVE]] [[CVSS]] [[Nessus]] [[OpenVAS]] [[Cybersecurity/Tags/Documentation & Reporting|Documentation & Reporting]]

References: https://academy.hackthebox.com/module/108/section/1160


# Vulnerability Assessment

- a process which is done on networks, computers and applications
- it's purpose is to find vulnerabilities in order to patch, mitigate or even remove them

# Security Assessments
## Types of Boxes
### Black Box
- no knowledge of network or apps
- if the pentest is ==internal==, the pentester will receive local network access
- if the pentest is ==external==, the pentester will only be given the company's name
### Grey Box
- a bit of knowledge of the network (perspective of an employee who doesn't work in IT)
- network range's or individual IPs are given
### White Box
- full access to all systems, configurations, etc.

## Types of Pentesters
### Application Pentesters
- assess web apps, thick-client apps, APIs, mobile apps, etc.
- do source code review - secure code review
### Network and Infrastructure Pentesters
- assess all aspects of computer networks
- skills needed: Windows, Linux, Active Directory, scripting language
- network vulnerability scanners such as ==Nessus==
### Physical
- leverage physical security weaknesses
- gain access to a facility
### Social Engineering
- testing human beings
- phishing, vishing, scams
## Vulnerability Assessments vs. Penetration Tests
- vulnerability assessments only look for vulnerabilities without performing attacks
- penetration tests are basically simulated cyber attacks
![[VulnerabilityAssessment_Diagram_02.png]]
## Methodology
![[VulnerabilityAssessment_Diagram_06a.png]]
## Key Terms
![[threat_vulnerability_risk.png]]

==Note: Vulnerabilities can be registered through MITRE's [Common Vulnerability Exposure database](https://cve.mitre.org/) and receive a [Common Vulnerability Scoring System (CVSS)](https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator) score to determine severity.==

- an ==Exploit== is any code or resource that can be used to take advantage of a weakness

![[whatisrisk.png]]

- `Risk`: something bad that could happen
- `Threat`: something bad that is happening
- `Vulnerabilities`: weaknesses that could lead to a threat

## Asset Management
### Asset Inventory
- information technology, operational technology, physical, software, mobile and development

## Assessment Standards
### Compliance Standards
Examples: `PCI`, `HIPAA`, `FISMA`, and `ISO 27001` (the big boys)
- [Payment Card Industry Data Security Standard (PCI DSS)](https://www.pcisecuritystandards.org/pci_security/) for organizations that use credit cards
![[PCI-DSS-Goals.webp]]
- [Health Insurance Portability and Accountability Act](https://www.hhs.gov/programs/hipaa/index.html) used to protect patient's data
- [Federal Information Security Management Act (FISMA)](https://www.cisa.gov/federal-information-security-modernization-act) for safeguarding government operations and security
- [ISO 27001](https://www.iso.org/isoiec-27001-information-security.html) requires organizations to perform quarterly internal and external scans
### Penetration Testing Standards
#### PTES ([Penetration Testing Execution Standard](http://www.pentest-standard.org/index.php/Main_Page))
- can be applied for ALL pentests
Sections:
- Pre-engagement Interactions
- Intelligence Gathering
- Threat Modeling
- Vulnerability Analysis
- Exploitation
- Post Exploitation
- Reporting
#### OSSTMM (Open Source Security Testing Methodology Manual)
[OSSTMM](https://www.isecom.org/OSSTMM.3.pdf) is divided into 5 areas:
1. Human Security (human beings are subject to social engineering exploits)
2. Physical Security
3. Wireless Communications (including but not limited to technologies like WiFi and Bluetooth)
4. Telecommunications
5. Data Networks
#### NIST (National Institute of Standards and Technology)
- well know for [NIST Cybersecurity Framework](https://www.nist.gov/cyberframework) (framework for developing incident response policies and procedures)
Phases of NIST framework:
- Planning
- Discovery
- Attack
- Reporting
#### OWASP ([Open Web Application Security Project](https://owasp.org))
- main organization for defining web apps security issues
OWASP has a few different standards:
- [Web Security Testing Guide (WSTG)](https://owasp.org/www-project-web-security-testing-guide/)
- [Mobile Security Testing Guide (MSTG)](https://owasp.org/www-project-mobile-security-testing-guide/)
- [Firmware Security Testing Methodology](https://github.com/scriptingxss/owasp-fstm)

# Vulnerability Scoring and Reporting
## Common Vulnerability Scoring System (CVSS)
- a way to calculate severity ratings of vulnerabilities (based on exploitability and impact)
- it's often used with [Microsoft DREAD](https://en.wikipedia.org/wiki/DREAD_(risk_assessment_model)) (risk assessment system)

Risk of a threat or vulnerability is calculated based on:
- Damage Potential
- Reproducibility
- Exploitability
- Affected Users
- Discoverability
![[VulnerabilityAssessment_Diagram_08.png]]
- the base metric group refers to CIA impact metrics and exploitability metrics
![[cia_triad.png]]
==Note==: Remember that every part of the CIA triad has an `Impact` aspect to it.
- the `Temporal Group` refers to availability of exploits or patches regarding the issue
- `Exploit Code Maturity` is the probability of an issue being exploited
- `Remediation Level` is used to identify the prioritization of a vulnerability
- `Report Confidence` is the validation of the vulnerability
- the `Environmental Metric Group` represents the significance of a vulnerability based on the CIA triad
- `Modified Base Metrics` refers to base metrics which the organization can modify if it deems necessary
## Common Vulnerabilities and Exposures (CVE)
- [Open Vulnerability Assessment Language (OVAL)](https://oval.mitre.org/) is an international security standard that refers to the state of a system and it's issues
OVAL process:
![[VulnerabilityAssessment_Diagram_05.png]]
The goal of the OVAL language is to have a three-step structure during the assessment process that consists of:
- Identifying a system's configurations for testing
- Evaluating the current system's state
- Disclosing the information in a report
The four main classes of OVAL definitions consist of:
- **OVAL Vulnerability Definitions**: Identifies system vulnerabilities
- **OVAL Compliance Definitions**: Identifies if current system configurations meet system policy requirements
- **OVAL Inventory Definitions**: Evaluates a system to see if a specific software is present
- **OVAL Patch Definitions**: Identifies if a system has the appropriate patch

- [Common Vulnerabilities and Exposures (CVE)](https://cve.mitre.org/) is a publicly available catalog of security issues which allows IT professionals to better understand certain security problems
![[VulnerabilityAssessment_Diagram_01.png]]

# Vulnerability Scanning Overview
- automated process focused on finding potential or know vulnerabilities on the network or application level
- vulnerability scanners do not exploit (with some exceptions) and need a human to validate scan issues (possible false positives)
- dynamic an static testing (static is based on known CVEs and dynamic is based on active trial and error pentesting with payloads - weak credentials, SQL injection or command injection)+
## Nessus Overview (Nessus Essentials)
- Nessus Essentials is the free community version
- up to 16 hosts
![[Nessus_Essentials___Folders___View_Scan 1.png]]
## OpenVAS Overview
- open-source vulnerability scanner
![[dashboard.webp]]
## Nessus
![[init.webp]]
- a new scan can be configured by clicking **new scan**
- there are 3 main categories of scans: discovery, vulnerabilities and compliance
- scan templates can be created through scan policies
- it works with plugins written in NASL (Nessus Attack Scripting Language) that can target new vulnerabilities and CVEs
- it provides descriptions and mitigations of what it detects
- plugin rules can also be created (exclude certain hosts for example) so that we can filter out false positives
- Nessus also supports credentials scanning
- completed scans generate a **report** which can be exported as **.pdf, .html or .csv**
- completed scans can also be exported as they are in two formats **.nessus (it's .xml basically) or .db**
## OpenVAS
![[Greenbone_Security_Assistant.webp]]
- publicly available vulnerability scanner

Installation:
1) `apt install docker.io` // Install Docker
2) `docker run -d -p 443:443 --name openvas mikesplain/openvas` // Install OpenVAS container
3) Launch OpenVAS - https://127.0.0.1:443 (admin:admin)

Types of scans(recommended):
- `Base`: This scan configuration is meant to enumerate information about the host's status and operating system information. This scan configuration does not check for vulnerabilities.
- `Discovery`: This scan configuration is meant to enumerate information about the system. The configuration identifies the host's services, hardware, accessible ports, and software being used on the system. This scan configuration also does not check for vulnerabilities.
- `Host Discovery`: This scan configuration solely tests whether the host is alive and determines what devices are `active` on the network. This scan configuration does not check for vulnerabilities as well. _OpenVAS leverages ping to identify if the host is alive._
- `System Discovery`: This scan enumerates the target host further than the 'Discovery Scan' and attempts to identify the operating system and hardware associated with the host.
- `Full and fast`: This configuration is recommended by OpenVAS as the safest option and leverages intelligence to use the best NVT checks for the host(s) based on the accessible ports.
## Reporting
### Executive Summary
- it's basically a simplified report which shows to a non-technical person what are the most important items to fix depending on the severity (when it comes to vulnerability assessments)
- allows for easy prioritization of remediation
![[graph.png]]
- example of a graphical view for the executive summary
### Overview of Assessment
- describe methodology used during assessment (process and tools used)
### Scope and Duration
- include the target scope (hosts) and period of assessment
### Vulnerabilities and Recommendations
- detail findings discovered during vulnerability assessment (after eliminating false positives)
Each issue should have the following elements:
- Vulnerability Name
- CVE
- CVSS
- Description of Issue
- References
- Remediation Steps
- Proof of Concept
- Affected Systems



# Useful Links:

https://www.exploit-db.com/
https://www.rapid7.com/db/
https://cve.mitre.org/
https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator
https://www.first.org/cvss/calculator/4.0
https://docs.tenable.com/nessus/Content/ScanAndPolicyTemplates.htm //Nessus scan types